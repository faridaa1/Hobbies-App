{% extends "api/spa/index.html" %}


{% block header_css %}
<style>
    .field-error {
        color: #e12638;
        margin-bottom: 0.2rem;
    }

    .hidden {
        display: none !important;
    }

    .container {
        max-width: 40rem;
    }

</style>
{% endblock %}


{% block content %}
<div class="mt-5 container p-5 border">
    <h1 class="text-center mb-4">Login</h1>
    <form method="post" action="/login/" class="login-form" id="login-form">
        <div class="container">
            <div class="form-content row">
                <div class="col d-flex flex-column">
                    {% csrf_token %}
                    {% for field in form %}
                        <div class="mb-3">
                            <label id="{{field.id_for_label}}" class="form-label">{{field.label}}</label> 
                            {{field}}
                            {% if field.label == 'Password' %}
                                <div class="form-check mt-1">
                                    <input type="checkbox" id="show-password" name="show-password" class="form-check-input"/>
                                    <label for="show-password" class="form-check-label">Show Password</label>
                                </div>
                            {% endif %}
                            {% for error in field.errors %}
                                <p class="field-error">{{error}}</p>
                            {% endfor %}
                        </div>
                    {% endfor %}
                    {% if form.non_field_errors %}
                        {% for error in form.non_field_errors %}
                            <p class="field-error">{{error}}</p>
                        {% endfor %}
                    {% endif %}
                </div>
            </div>
        </div>
        <button class="btn btn-primary w-100" type="submit" name="submit">LOG IN</button>
        <div class="row">
            <a href="/signup" class="text-center my-3" style="color: black;">New user? Sign up here</a>
        </div>
    </form>
</div>
{% endblock %}


{% block js %}
<script>
    const form = document.getElementById('login-form')
    const passwordInput = document.querySelector('input[type="password"]')
    const passwordToggle = document.getElementById('show-password')

    passwordToggle.addEventListener('input', (e) => {
        passwordInput.type = passwordInput.type === 'password' ? 'text' : 'password'
    })
    
    form.addEventListener('submit', (e) => {
        passwordInput.type = 'password' // Don't want it to be saved by autofill
    })
</script>
{% endblock %}